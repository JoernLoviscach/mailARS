<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mailARS: User Manual</title>
    <style>
        body {
            font-family: Georgia, serif;
        }

        .typewriter {
            font-family: Consolas, monospace;
        }

        img {
            width: 16px;
            height: 16px;
        }
    </style>
</head>

<body>

    <h1>mailARS 1.0.4</h1>

    <h2>What’s this?</h2>
    <p>mailARS is an open-sourced application for Windows, macOS, and Linux,
        that enables sending quizzes and problems to students to individually
        work on during class (typically a virtual class) und submit their work
        electronically, possibly as a photo. Teachers can react upon such
        submissions both individually and to the entire class. mailARS is
        intended to be used alongside video conferencing software. Concerning
        the didactics, see the (German) <a
            href="https://www.pedocs.de/frontdoor.php?source_opus=17938">paper</a>
        on its browser-based predecessor.</p>
    <p>Technically speaking, mailARS is an e-mail client that works with
        graphics rather than with text. This reason behind this solution is the
        <a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj">GDPR</a>, as
        mailARS only employs a school’s existing e-mail system, for which
        GDPR-conformant regulations and processes are required to already be in
        place. Hence, the use of mailARS should not require further
        organizational work.</p>
    <p>For news about updates please follow: <a
            href="https://j3l7h.de/blog/">https://j3l7h.de/blog/</a></p>

    <h2>Installation</h2>
    <p>mailARS works with e-mail servers that employ the protocols SMTP und
        IMAP. Should your school use different protocols or additional
        authentication, you need to adapt or augment the source code contained
        in the file mailing.py.</p>
    <p>If you want to use a smartphone or tablet for drawing, you should connect
        this as an <a
            href="https://techwiser.com/use-your-android-as-second-monitor/">additional
            display</a> and drag mailARS’s drawing windows there. A smartphone
        <a href="https://www.wired.com/story/use-your-phone-as-webcam/">could be
            used</a> as webcam.</p>
    <p>mailARS is written in Python and requires Python&nbsp;3.7 or younger for
        execution; Python&nbsp;3.8 or newer is advisable. On Windows&nbsp;10,
        you can install Python from the <a
            href="https://www.microsoft.com/en-us/p/python-38/9mssztt1n39l">Microsoft
            Store</a>. By default, macOS contains only Python&nbsp;2.x; it needs
        to be <a
            href="https://www.interglobalmedianetwork.com/blog/2020-05-29-installing-the-latest-version-of-python-on-mac-os-catalina-and-overriding-the-old-default-pre-installed-version/">updated</a>.
        On Linux, an up-to-date version of Python should already be installed.
        For other operating systems see <a
            href="https://www.python.org/">Python.org</a>.</p>
    <p>To check whether or not Python is installed correctly, open a terminal
        window (Windows&nbsp;10: type <span class="typewriter">cmd</span> into
        the search box) and type <span class="typewriter">python⏎</span> into
        it. After that, Python should respond with its versions number. (If
        Python is not installed system-wide on Windows&nbsp;10, the Windows
        Store will open instead.) Verify the version number. To prevent
        confusion, only one version of Python should be installed. After that,
        leave Python by typing <span class="typewriter">quit()⏎</span>.</p>
    <p>mailARS requires a library for its graphical user interface and a library
        to access the webcam. Hence, while being connected to the internet,
        enter the following into the above-mentioned terminal window (not into
        Python!):<br>
        <span class="typewriter">pip install pyqt5 opencv-python
            numpy==1.19.3⏎</span><br> On macOS, use this instead:<br>
        <span class="typewriter">pip install pyqt5
            opencv-python-headless⏎</span><br> (Hint: Copy the respective line
        from this text, without the arrow ⏎.) Typically, you can ignore
        subsequent warnings concerning an old version of pip or concerning paths
        that are not set.
    </p>
    <p>You should have received mailARS as a zip archive, which also contains
        this user manual. Check this zip archive with a virus scanning tool, for
        instance online with <a
            href="https://www.virustotal.com/">VirusTotal</a>. Unpack the zip
        archive (Windows: right mouse button, Extract All). mailARS needs to
        write files into its folder; hence, it cannot be launched from the
        compressed zip archive.</p>
    <p>You launch mailARS by double clicking the file <span
            class="typewriter">__main__.py</span>. On Windows: To prevent a
        terminal window opening in addition to the graphical user interface, you
        can rename this file to <span class="typewriter">__main__.pyw</span>. To
        perform this renaming correctly, you have to set Windows to <a
            href="https://support.microsoft.com/en-us/windows/common-file-name-extensions-in-windows-da4a4430-8e76-89c5-59f7-1cdbbc75cb01">display</a>
        filename extensions; for security reasons, you should anyway have
        Windows display the extensions at all times. </p>
    <p>If a firewall is installed on your computer, you may need to configure it
        in such a manner that mailARS can access the ports 587 (SMTP) and 993
        (IMAP).</p>
    <p>Other software such as GIMP or Inkscape that uses Python may momentarily
        change Python’s settings so that mailARS cannot be run in parallel to
        those.</p>

    <h2>Settings</h2>
    <p>On every launch, mailARS asks for the e-mail password. For security
        reasons the password is not stored along with the other settings.</p>
    <p>To adjust and save the remaining settings of mailARS click onto <img
            src="images/settings.png" alt="Settings"> in its main window. Enter
        the following (if it’s not already present) into the dialog that appears
        afterwards:</p>
    <ul>
        <li>Language: the language of user interface; changes are applied from
            the next launch of mailARS on.</li>
        <li>Name to be displayed: a name or a pseudonym to be shown to
            recipients; if you leave this field empty, it will be filled with a
            random number during the next launch of mailARS</li>
        <li>SMTP sender: your e-mail address for sending mail</li>
        <li>IMAP user: your user name for fetching mail, possibly identical to
            your e-mail address on the previous line </li>
        <li>SMTP receiver: the e-mail address of your teacher; teachers leave
            this field empty</li>
        <li>SMTP server: the address of your school’s server for sending mail
        </li>
        <li>IMAP server: the address of your school’s server for fetching mail
        </li>
        <li>Smooth curves after drawing: typically, you want to switch this on,
            unless you are using a graphics tablet with an active stylus.</li>
    </ul>

    <h2>Basic functions</h2>
    <p>The main window of mailARS shows the mail boxes (Inbox, Drafts, Outbox).
        To quit the program, close that window (not simply minimizing it).</p>
    <p>Click <img src="images/fetch.png" alt="Fetch mail"> to fetch mail from
        the server. This button is colored red <img
            src="images/need_to_fetch.png" alt="Fetch mail (in red)"> when new
        mails have been available on the server for about one minute. Should
        there be a problem when fetching mail (typically a typo in the
        password), a time-stamped notification will appear on the status bar at
        the bottom of that window.</p>
    <p>To limit the number of thumbnails, teachers should switch on <img
            src="images/group_by_sender.png"
            alt="Only show latest mail of every sender"> so that the inbox only
        shows the latest mail of every sender. The size of the thumbnail
        previews in the mailboxes (or rather; how many columns are formed at
        maximum), can be controlled through the slider that appears after a
        click on <img src="images/columns.png" alt="Number of columns">.</p>
    <p>If you let the mouse hover above one of the thumbnail previews in one of
        the three mailboxes, a tooltip will appear that displays the names of
        the addressees and the time stamp of the mail or the time of creation of
        a draft. A click on <img src="images/export_to_pdf.png"
            alt="PDF export"> initiates the PDF export of all mails of the
        currently visible mailbox as pages of a PDF file stored in the mailARS
        subdirectory <span class="typewriter">export</span>. In case you want to
        export only some of the mails, you can select those beforehand with help
        of the checkboxes at the left top of the thumbnails. To select more than
        one, press the Shift key while clicking.</p>
    <p>You can create a new mail by clicking on <img src="images/new.png"
            alt="New draft">. Afterwards and also if you click on a thumbnail in
        one of the three mailboxes, mailARS opens a drawing window for editing.
        A number of different drawing windows can be open at the same time.</p>
    <p>To send a mail, you click on <img src="images/send.png" alt="Send"> in
        the drawing window. Should there be a problem when sending the mail
        (typically a typo in the password), a time-stamped notification will
        appear on the status bar at the bottom of the main (!) window.</p>
    <p>You can keep the drawing window open, continue working in it and send the
        current state from time to time. The Send button is colored red <img
            src="images/need_to_send.png" alt="Send (in red)"> if you have
        edited the mail in the drawing window. If you have edited a mail and
        close the drawing window without having sent the mail, it is stored in
        the Drafts mailbox. To be precise, when opening a mail, mailARS creates
        a temporary draft copy unless that mail is already a draft; if you do
        not edit the draft copy, it will be removed again after the drawing
        window has been closed.</p>
    <p>Before sending a mail you can check and edit its list of addressees. To
        this end, click on <img src="images/addressees.png" alt="Addressees">.
    </p>
    <p>To prevent flooding your general IMAP inbox, which is also visible in the
        regular e-mail client program that you have been using all along,
        mailARS creates a folder called mailARS in the IMAP inbox and moves all
        mails with subject line <span class="typewriter">mailARS, not intended
            for reading</span> into this folder. For safety reasons, these mails
        are not deleted automatically. From time to time, you should use your
        regular e-mail client program to check this folder for stray messages
        and to delete all messages in it. In Thunderbird, for instance, you have
        to subscribe to that – otherwise invisible – folder (right mouse click
        on the title of the mail account in the list at the left border of the
        screen). Should you have set up automatic mail forwarding from the
        school’s mail server to a different server, mailARS’s automatic moving
        of mails does not help; anyway, it is better to access the school’s mail
        server directly, for instance through an e-mail client such as <a
            href="https://www.thunderbird.net/">Thunderbird</a>, which can
        handle mail accounts on different servers in parallel.</p>

    <h2>Drawing functions</h2>
    <p>Click on <img src="images/draw.png" alt="Drawing"> for the drawing tool
        <img src="images/cursor_drawing_b.png" alt="Drawing tool">. Click on
        <img src="images/color.png" alt="Color"> to open the color picker dialog
        or on <img src="images/stroke_thickness.png" alt="Thickness"> to set the
        stroke thickness using a slider. A preview next to both buttons shows
        the effect of these two settings. Click <img src="images/erase.png"
            alt="Erase"> for the eraser <img src="images/cursor_erasing_b.png"
            alt="Eraser">. It removes entire pen strokes and leaves texts and
        pictures untouched. You can momentarily switch from drawing to erasing
        by pressing the right mouse button or by using the inverted end of an
        active stylus (if it supports this) or by pressing the stylus’ button
        that is configured to act as right mouse button.</p>
    <p>Click on <img src="images/text.png" alt="Typing"> to select the text tool
        <img src="images/cursor_typing_b.png" alt="Text tool">. Use this tool to
        create a rectangular frame; afterwards, you can type and edit text in
        this frame as usual. At least on Windows you can use the operating
        system’s support for alternative text input such as Pinyin. To change
        the position and/or the size of the frame, apply the text tool drag its
        borders. To adjust the font size, click on <img
            src="images/font_size.png" alt="Size"> and set the slider that
        appears afterwards. To edit exiting text, use the text tool to click on
        it.</p>
    <p>To take a photo with the webcam, click on <img src="images/photo.png"
            alt="Photo">. Afterwards, mailARS opens a window with a live preview
        of the camera, allowing you to cancel this operation or to insert the
        current picture into the drawing. The preview is mirrored so that you
        can more easily adjust the paper in front of the webcam. The image
        delivered by the webcam is optimized for maximum contrast so that
        drawings and handwritten text are captured well even under poor lighting
        conditions. Note that a webcam has to be connected and must not
        currently be in use. Hence, you have to temporarily pause the webcam in
        video conferencing software that runs in parallel to mailARS.</p>
    <p>Click on <img src="images/select.png" alt="Select"> for the selection
        tool <img src="images/cursor_selecting_b.png" alt="Selection tool">. Use
        this tool to select one object or several objects by clicking onto an
        individual object or by drawing a rectangle that encloses or intersects
        a number of objects. If you press the Shift key while releasing the
        mouse button, the former selection is extended to include the current
        objects; if you press the Control key, the current objects are removed
        from the former selection.</p>
    <p>mailARS displays two handles in the middle of the selection: <img
            src="images/move.png" alt="Move"> und <img src="images/scale.png"
            alt="Scale">. By dragging one of these, you control the position and
        the size of the selected objects. Changes of stroke width, stroke color,
        and font size are applied to all currently selected objects. By clicking
        on <img src="images/delete.png" alt="Deleted"> you delete all currently
        selected objects or – should none have been selected – all objects.</p>
    <p>Undo and redo are invoked by clicking on <img src="images/undo.png"
            alt="Undo"> and <img src="images/redo.png" alt="Redo">. While
        editing text, use the key combinations Ctrl+Z and Ctrl+Y instead.</p>
    <p>By pressing the P key you can hide and show the toolbar. This helps
        saving space on the screen, reducing visual distractions and preventing
        inadvertent changes of the drawing window’s size or position. All
        functions can be invoked through the keys that appear in the tooltips of
        the corresponding buttons on the toolbar. The keys 1 through 6 invoke
        preset colors. When using the keys, take care of the drawing window
        being the active (usually the topmost) window so that key presses are
        not send to the wrong window or even the wrong program such as the web
        browser. In text editing mode, you cannot use the key commands as they
        would end up as characters in the text. To prevent this, leave the text
        frame by clicking the X in its lower right corner.</p>

    <h2>Tips for teachers</h2>
    <p>To distribute mailARS among your students, you should</p>
    <ol>
        <li>copy the mailARS folder,</li>
        <li>launch mailARS from that folder,</li>
        <li>in the settings, delete the name to be displayed so that a random
            number will be generated on the next launch of mailARS,</li>
        <li>complete – as far as possible – the mail settings from the students’
            perspective,</li>
        <li>drag the windows to the left and top of your (primary, should you
            use several) display screen and reduce their sizes, as the positions
            and sizes are stored,</li>
        <li>quit mailARS,</li>
        <li>with exception of the folder <span class="typewriter">images</span>
            delete all folders (which will be recreated automatically) within
            the copy of the mailARS folder (data protection!), and</li>
        <li>turn the copy of the mailARS folder into a zip archive (Windows:
            right mouse button, Send to: Compressed (zipped) folder), which you
            send to the students.</li>
    </ol>
    <p>As an alternative to distributing the bare Python code, you can hand a
        complete Python environment (that possibly even does not require
        installation) to your students, for instance based on <a
            href="https://sourceforge.net/projects/winpython/files/WinPython_3.7/3.7.4.1/WinPython64-3.7.4.1Zero.exe">WinPython
            Zero</a>.</p>
    <p>Ask your students at the start of the term to send you an empty drawing
        through mailARS. This way, your copy of mailARS collects the mail
        addresses so that you can send problems to everybody.</p>
    <p>At the beginning of every session, you should open a new drawing window
        and use this as the central whiteboard for your class. If you use only a
        single display screen, you should (screen-)share only this single
        drawing window with your students and not transmit the entire screen. If
        you use two display screens, you can extend this central drawing window
        to one of the screens (which you then share) and move all other mailARS
        windows (including further drawing windows) to the other screen. As
        mailARS opens every further drawing window at the position and in the
        size of the drawing window moved last, it is sufficient to drag a single
        drawing window to the second screen. Then, all further drawing screens
        will appear on the second screen. </p>
    <script>
        Array.from(document.getElementsByTagName('img'))
            .forEach(el => el.setAttribute('title', el.getAttribute('alt')));
    </script>
</body>

</html>